"use strict";(self["webpackChunkedu_fed"]=self["webpackChunkedu_fed"]||[]).push([[378],{6657:function(e,t,a){a.r(t),a.d(t,{default:function(){return b}});var r=function(){var e=this,t=e._self._c;return t("div",[t("user-list")],1)},s=[],l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"user-list"},[t("el-form",{ref:"filter-form",attrs:{inline:!0,model:e.filterParams}},[t("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[t("el-input",{attrs:{placeholder:"请输入手机号"},model:{value:e.filterParams.phone,callback:function(t){e.$set(e.filterParams,"phone",t)},expression:"filterParams.phone"}})],1),t("el-form-item",{attrs:{label:"注册时间",prop:"rangeDate"}},[t("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"yyyy-MM-dd"},model:{value:e.filterParams.rangeDate,callback:function(t){e.$set(e.filterParams,"rangeDate",t)},expression:"filterParams.rangeDate"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary",disabled:e.isLoading},on:{click:e.handleQuery}},[e._v("查询 ")]),t("el-button",{attrs:{disabled:e.isLoading},on:{click:e.handleReset}},[e._v("重置 ")])],1)],1),t("el-card",[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticStyle:{width:"100%"},attrs:{data:e.users}},[t("el-table-column",{attrs:{prop:"id",label:"用户ID",width:"120",align:"center"}}),t("el-table-column",{attrs:{prop:"name",label:"头像",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[t("img",{staticStyle:{"border-radius":"50%"},attrs:{width:"30px",src:e.row.portrait||"http://www.lgstatic.com/thumbnail_100x100/i/image2/M01/5E/65/CgotOVszSAOANi0LAAAse2IVWAE693.jpg"}})]}}])}),t("el-table-column",{attrs:{prop:"name",label:"用户名",align:"center"}}),t("el-table-column",{attrs:{prop:"phone",label:"手机号",align:"center"}}),t("el-table-column",{attrs:{prop:"createTime",label:"注册时间",align:"center"}}),t("el-table-column",{attrs:{prop:"name",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-switch",{attrs:{"active-value":"ENABLE","inactive-value":"DISABLE","active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(t){return e.handleForbidUser(a.row)}},model:{value:a.row.status,callback:function(t){e.$set(a.row,"status",t)},expression:"scope.row.status"}})]}}])}),t("el-table-column",{attrs:{prop:"address",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleSelectRole(a.row)}}},[e._v("分配角色")])]}}])})],1),t("el-dialog",{attrs:{title:"分配角色",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-select",{attrs:{multiple:"",placeholder:"请选择"},model:{value:e.roleIdList,callback:function(t){e.roleIdList=t},expression:"roleIdList"}},e._l(e.roles,(function(e){return t("el-option",{key:e.value,attrs:{label:e.name,value:e.id}})})),1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleAllocRole}},[e._v("确 定")])],1)],1),t("el-pagination",{attrs:{"current-page":e.filterParams.currentPage,"page-sizes":[10,15,20],"page-size":e.filterParams.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalCount,disabled:e.isLoading},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},i=[],n=a(6301),o=a(2307),d={name:"UserList",data(){return{users:[],filterParams:{currentPage:1,pageSize:10,phone:"",startCreateTime:"",endCreateTime:"",rangeDate:[]},totalCount:0,isLoading:!0,dialogVisible:!1,roles:[],roleIdList:[],currentRoleID:null}},created(){this.loadUsers()},methods:{async loadUsers(){this.isLoading=!0;const{rangeDate:e}=this.filterParams;e&&e.length?(this.filterParams.startCreateTime=e[0],this.filterParams.endCreateTime=e[1]):(this.filterParams.startCreateTime="",this.filterParams.endCreateTime="");const{data:t}=await(0,n.h5)(this.filterParams);this.users=t.data.records,this.totalCount=t.data.total,this.isLoading=!1},async handleForbidUser(e){const{data:t}=await(0,n.N8)(e.id);"000000"===t.code?this.$message.success("禁用成功！"):this.$message.error("暂不提供禁用功能！")},async handleSelectRole(e){this.currentRoleID=e.id,this.dialogVisible=!0;const{data:t}=await(0,o.xJ)();"000000"===t.code&&(this.roles=t.data);const{data:a}=await(0,o.Jm)(e.id);"000000"===a.code&&(this.roleIdList=a.data.map((e=>e.id)))},async handleAllocRole(){const{data:e}=await(0,o.uD)({userId:this.currentRoleID,roleIdList:this.roleIdList});"000000"===e.code&&(this.$message.success("分配角色成功"),this.dialogVisible=!1)},handleReset(){this.$refs["filter-form"].resetFields(),this.loadUsers()},handleQuery(){this.filterParams.current=1,this.loadUsers()},handleSizeChange(e){this.filterParams.pageSize=e,this.filterParams.currentPage=1,this.loadUsers(this.filterParams)},handleCurrentChange(e){this.filterParams.currentPage=e,this.loadUsers(this.filterParams)}}},u=d,c=a(1001),h=(0,c.Z)(u,l,i,!1,null,"0c0ae047",null),m=h.exports,f={name:"UserIndex",components:{UserList:m}},p=f,g=(0,c.Z)(p,r,s,!1,null,"2b6bef2c",null),b=g.exports},2307:function(e,t,a){a.d(t,{Jm:function(){return d},Rd:function(){return l},VZ:function(){return s},bM:function(){return i},uD:function(){return o},xJ:function(){return n}});var r=a(5286);const s=e=>(0,r.Z)({method:"POST",url:"/boss/role/getRolePages",data:e}),l=e=>(0,r.Z)({method:"DELETE",url:`/boss/role/${e}`}),i=e=>(0,r.Z)({method:"POST",url:"/boss/role/saveOrUpdate",data:e}),n=()=>(0,r.Z)({method:"GET",url:"/boss/role/all"}),o=e=>(0,r.Z)({method:"POST",url:"/boss/role/allocateUserRoles",data:e}),d=e=>(0,r.Z)({method:"GET",url:`/boss/role/user/${e}`})},6301:function(e,t,a){a.d(t,{N8:function(){return d},bG:function(){return n},h5:function(){return o},x4:function(){return i}});var r=a(5286),s=a(129),l=a.n(s);const i=e=>(0,r.Z)({method:"POST",url:"/front/user/login",data:l().stringify(e)}),n=()=>(0,r.Z)({method:"GET",url:"/front/user/getInfo"}),o=e=>(0,r.Z)({method:"POST",url:"/boss/user/getUserPages",data:e}),d=e=>(0,r.Z)({method:"POST",url:`/boss/user/forbidUser?userId=${e}`})}}]);
//# sourceMappingURL=user.7ea9cbf4.js.map