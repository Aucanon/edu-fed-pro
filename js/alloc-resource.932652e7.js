"use strict";(self["webpackChunkedu_fed"]=self["webpackChunkedu_fed"]||[]).push([[926],{6040:function(e,t,s){s.r(t),s.d(t,{default:function(){return i}});var c=function(){var e=this,t=e._self._c;return t("div",{staticClass:"alloc-resource"},[t("el-card",[e._l(e.categoryList,(function(s){return t("div",{key:s.id,staticStyle:{"border-top":"1px solid #dcdfe6"}},[t("el-row",{staticStyle:{"background-color":"rgb(242, 246, 252)"}},[t("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v(e._s(s.name))])],1),t("el-row",[t("el-checkbox-group",{on:{change:e.handleCheckedKeysChange},model:{value:e.checkedKeys,callback:function(t){e.checkedKeys=t},expression:"checkedKeys"}},e._l(e.cateSource(s.id),(function(s){return t("el-checkbox",{key:s.id,staticStyle:{width:"30%"},attrs:{label:s.id}},[e._v(" "+e._s(s.name)+" ")])})),1)],1)],1)})),t("div",{staticClass:"btn"},[t("el-button",{attrs:{type:"primary"},on:{click:e.onSave}},[e._v("保存")]),t("el-button",{on:{click:e.onReset}},[e._v("清空")])],1)],2)],1)},r=[],o=(s(7658),s(7304)),a={name:"AllocResource",props:{roleId:{type:[Number,String],required:!0}},data(){return{checkAll:!1,sourceList:[],categoryList:[],checkedKeys:[],isIndeterminate:!0}},created(){this.loadAllResource(),this.loadResourceCategory(),this.loadRoleResource()},methods:{cateSource(e){let t=[];return this.sourceList.forEach((s=>{s.categoryId===e&&(t=[...t,s])})),t},handleCheckAllChange(e){this.checkedKeys=e?this.sourceList:[],this.isIndeterminate=!1},handleCheckedKeysChange(e){console.log(e),this.checkedKeys=e;const t=e.length;this.checkAll=t===this.sourceList.length,this.isIndeterminate=t>0&&t<this.sourceList.length},getCheckedKeys(e){e.forEach((e=>{if(e.selected)return e.resourceList?this.getCheckedKeys(e.resourceList):void(this.checkedKeys=[...this.checkedKeys,e.id])}))},async loadAllResource(){const{data:e}=await(0,o.iA)();"000000"===e.code&&(this.sourceList=e.data)},async loadResourceCategory(){const{data:e}=await(0,o.Jh)();"000000"===e.code&&(this.categoryList=e.data)},async loadRoleResource(){const{data:e}=await(0,o.xK)(this.roleId);"000000"===e.code&&this.getCheckedKeys(e.data)},async onSave(){const{data:e}=await(0,o.h)({roleId:this.roleId,resourceIdList:this.checkedKeys});"000000"===e.code&&(this.$message.success("保存成功！"),this.$router.push({name:"role"}))},onReset(){this.checkedKeys=[],this.isIndeterminate=!1}}},n=a,l=s(1001),u=(0,l.Z)(n,c,r,!1,null,"d1c24dbe",null),i=u.exports},7304:function(e,t,s){s.d(t,{Jh:function(){return a},KQ:function(){return u},LR:function(){return n},RT:function(){return o},fg:function(){return l},h:function(){return y},iA:function(){return r},u_:function(){return i},uu:function(){return d},xK:function(){return h}});var c=s(5286);const r=()=>(0,c.Z)({method:"GET",url:"/boss/resource/getAll"}),o=e=>(0,c.Z)({method:"POST",url:"/boss/resource/getResourcePages",data:e}),a=()=>(0,c.Z)({method:"GET",url:"/boss/resource/category/getAll"}),n=e=>(0,c.Z)({method:"POST",url:"/boss/resource/saveOrUpdate",data:e}),l=e=>(0,c.Z)({method:"DELETE",url:`/boss/resource/${e}`}),u=()=>(0,c.Z)({method:"GET",url:"/boss/resource/category/getAll"}),i=e=>(0,c.Z)({method:"POST",url:"/boss/resource/category/saveOrderUpdate",data:e}),d=e=>(0,c.Z)({method:"DELETE",url:`/boss/resource/category/${e}`}),h=e=>(0,c.Z)({method:"GET",url:`/boss/resource/getRoleResources?roleId=${e}`}),y=e=>(0,c.Z)({method:"POST",url:"/boss/resource/allocateRoleResources",data:e})}}]);
//# sourceMappingURL=alloc-resource.932652e7.js.map